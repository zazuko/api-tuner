PREFIX earl: <http://www.w3.org/ns/earl#>
PREFIX tuner: <https://api-tuner.described.at/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX log: <http://www.w3.org/2000/10/swap/log#>
PREFIX string: <http://www.w3.org/2000/10/swap/string#>
prefix resource: <https://api-tuner.described.at/resource#>

<#casing>
  a earl:TestCase ;
  rdfs:label "Headers can be asserted case-insensitive" ;
  tuner:formula {
    ( <http://localhost:1080/location-header> ?res ) resource:postIn [] .

    ?res tuner:header ( "Location" "http://foo.bar/baz" ) .
    ?res tuner:header ( "location" "http://foo.bar/baz" ) .
    (
      { ?res tuner:header ( "Location" "foobar" ) }
      {
        "Expected assertion failure"^tuner:info .
        true log:equalTo false .
      }
      true
    ) log:ifThenElseIn ?SCOPE .
  } ;
.

<#regex>
  a earl:TestCase ;
  rdfs:label "Headers can be asserted case-insensitive" ;
  tuner:formula {
    ( <http://localhost:1080/example.com> ?res ) resource:getIn [] .

    ?res tuner:header ( "content-type" "text/.*" string:matches ) .
    (
      { ?res tuner:header ( "content-type" "foobar" string:matches ) }
      {
        "Expected assertion failure"^tuner:info .
        true log:equalTo false .
      }
      true
    ) log:ifThenElseIn ?SCOPE .
  }
.
